WINDOWNAME:Zùstatek Dovolené:
INPUT:TEXTBOX:USR_KARTA:KARTA UŽIVATELE:CharacterCasing-Upper:UseSystemPasswordChar/True:Submit/True:
SQL:SELECT MAX(mzdy.stredisko) AS Støedisko,SUM(CASE WHEN (mzdy.dov_min_rok - (mzdy.dov_cerpana + mzdy.sl_dov_cerp) > 0) THEN (mzdy.dov_min_rok -(mzdy.dov_cerpana + mzdy.sl_dov_cerp))ELSE 0 END) AS RD_lonska, SUM(mzdy.dov_min_rok + mzdy.dov_cel_letos - mzdy.dov_cerpana - mzdy.sl_dov_cerp - mzdy.dov_kracena - mzdy.sl_dov_krac + CASE WHEN mzdy.dov_korekce > 0 THEN mzdy.dov_korekce ELSE 0 END - CASE WHEN mzdy.dov_min_rok -(mzdy.dov_cerpana + mzdy.sl_dov_cerp) > 0 THEN (mzdy.dov_min_rok - (mzdy.dov_cerpana + mzdy.sl_dov_cerp)) ELSE 0 END) AS RD_letosni,SUM(mzdy.dov_min_rok + mzdy.dov_cel_letos - mzdy.dov_cerpana - mzdy.sl_dov_cerp - mzdy.dov_kracena - mzdy.sl_dov_krac + mzdy.dov_korekce) AS RD_celkem, (SELECT TOP 1 os_konto.zustatek FROM DBNAME.dba.user_os_konto os_konto WHERE os_konto.oscislo = mzdy.oscislo ORDER BY os_konto.poradi DESC) as 'Zùstatek OS.Konta',(SELECT TOP 1 CONVERT(DATE,os_konto.platnost_do) FROM DBNAME.dba.user_os_konto os_konto WHERE os_konto.oscislo = mzdy.oscislo ORDER BY os_konto.poradi DESC) as 'Platnost OS.Konta do' FROM DBNAME.dba.mzdy mzdy,DBNAME.dba.ppom ppom WHERE ppom.oscislo = mzdy.oscislo AND mzdy.rok = CASE WHEN MONTH(GETDATE()) <> 1 THEN YEAR(GETDATE()) ELSE YEAR(GETDATE()) - 1 END AND mzdy.mesic = (SELECT MAX(mesic) FROM DBNAME.dba.mzdy WHERE oscislo = ppom.oscislo AND rok = CASE WHEN MONTH(GETDATE()) <> 1 THEN YEAR(GETDATE()) ELSE YEAR(GETDATE()) - 1 END AND mzdy.aktualizovan = 1) AND ppom.akt_stav = '10' AND ppom.kod_karty = *USR_KARTA* AND LEN(*USR_KARTA*) = 10 AND ppom.pp_do > GETDATE() GROUP BY mzdy.oscislo ORDER BY 2, 1
AUTOROOT:60
