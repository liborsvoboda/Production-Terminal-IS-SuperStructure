WINDOWNAME:Odvádění:
INPUT:COMBOBOX:USR_DATETYPE:Filtr Datumu:DropDownStyle/2:ITEMS/Denní!,Měsíční:
INPUT:DATE:USR_DATE:Datum Výkazu:TabStop/True:
INPUT:BUTTON:USR_BTN:Načíst Data:Submit/True:
INPUT:CHECKBOX:USR_CHBGROUP:Načíst Sumáře:Submit/True:
SQL:SELECT * FROM (SELECT t1_0.datum as 'Datum Odv.',CONVERT(NUMERIC(10,2),(select min(m.korun_vyp) from dba.zdr_vp_mzdy m where m.doklad=t1_0.doklad and m.polozka=t1_0.polozka)) as 'Odvod do mzdy' ,t1_0.doklad_zdr as 'Doklad Zdr.',t1_0.polozka_zdr as 'Oper',t4_2.nazev as 'Název',(coalesce((select max(n.user_kat_oznaceni) FROM dba.nomenklatura n with(index( pk_nomenklatura))WHERE n.id_nomen=(select max(v_opvvyrza.id_nomen) from dba.v_opvvyrza v_opvvyrza where v_opvvyrza.opv = t1_0.doklad_zdr)),'')) as 'Kat.Označení',CONVERT(NUMERIC(10,1),t1_0.mnozstvi_odv) as 'Odvedeno Mn.',CONVERT(NUMERIC(10,2),(((t1_0.hodin_poz_obs/(CASE WHEN t1_0.hodin_poz_obs_ta + t1_0.hodin_poz_obs_tb = 0 THEN 1 ELSE t1_0.hodin_poz_obs_ta + t1_0.hodin_poz_obs_tb END))-1)*100)) as 'Plnitelnost Norm.','Čas Celk.N' = CONVERT(NUMERIC(10,2),t1_0.hodin_poz_obs),'Čas Odv.' = CONVERT(NUMERIC(10,2),t1_0.hodin_odv_obs),(select o.popis from dba.zdr_vazby_mzdy o where o.xplan = t1_0.xplan and o.kod_vazby = (select zo.kod_vazby from dba.zdr_ope zo where zo.xplan=t1_0.xplan and zo.operace=t1_0.operace)) as 'Druh Práce' FROM dba.zdr_vp_pol t1_0,dba.zdr_vp_dkl t2_1 with(index( pk_zdr_vp_dkl)) ,dba.zakcis t3_13 with(index( pk_zakcis)) ,dba.zdr_uko t4_2 with(index( pk_zdr_uko)) ,dba.zdr_poz t5_3 with(index( pk_zdr_poz)) ,dba.odb_osoby t6_27 with(index( pk_odb_osoby)) WHERE ((t2_1.storno=0 and t1_0.kooperace=0 and t6_27.osoba='*USR_FLD1*') AND ( (*USR_DATETYPE* = 'Denní' AND t1_0.datum>=CONVERT(DATE,*USR_DATE*,105) AND t1_0.datum<DATEADD(DAY,1,CONVERT(DATE,*USR_DATE*,105))) OR (*USR_DATETYPE* = 'Měsíční' AND MONTH(t1_0.datum)=MONTH(CONVERT(DATE,*USR_DATE*,105)))) AND t1_0.fiskalni_rok=( YEAR( CONVERT(DATE,*USR_DATE*,105)) % 100 ) AND t6_27.osoba='*USR_FLD1*') AND (t2_1.doklad=t1_0.doklad) AND (t3_13.typ_zakazky=t1_0.typ_zakazky and t3_13.zakazka=t1_0.zakazka) AND (t4_2.id_ukolu=t1_0.id_ukolu) AND (t5_3.id_poz=t1_0.id_poz) AND (t6_27.osoba=t1_0.osoba) AND *USR_CHBGROUP*=0 UNION ALL SELECT 'Datum Odv.' = z.[Datum Odv.],'Odvod do mzdy' = SUM(z.[Odvod do mzdy]),'Doklad Zdr.' = MIN('Celkem'),'Oper' = MIN(z.[Oper]),'Název' = MIN(z.[Název]),'Kat.Označení' = MIN(z.[Kat.Označení]),'Odvedeno Mn.' = SUM(z.[Odvedeno Mn.]),'Plnitelnost Norm.' = SUM(z.[Plnitelnost Norm.]),'Čas Celk.N' = CONVERT(NUMERIC(10,2),SUM(z.[Čas Celk.N])),'Čas Odv.' =  CONVERT(NUMERIC(10,2),SUM(z.[Čas Odv.])),'Druh Práce'= MIN(z.[Druh Práce]) FROM (SELECT 'Datum Odv.' = t1_0.datum,'Odvod do mzdy' = CONVERT(NUMERIC(10,2),(select min(m.korun_vyp) from dba.zdr_vp_mzdy m where m.doklad=t1_0.doklad and m.polozka=t1_0.polozka)),'Doklad Zdr.' = '','Oper' = '','Název' = '','Kat.Označení' = '','Odvedeno Mn.' = CONVERT(NUMERIC(10,1),t1_0.mnozstvi_odv),'Čas Celk.N' = CONVERT(NUMERIC(10,2),t1_0.hodin_poz_obs),'Plnitelnost Norm.' = CONVERT(NUMERIC(10,2),(((t1_0.hodin_poz_obs/(CASE WHEN t1_0.hodin_poz_obs_ta + t1_0.hodin_poz_obs_tb = 0 THEN 1 ELSE t1_0.hodin_poz_obs_ta + t1_0.hodin_poz_obs_tb END))-1)*100)),'Čas Odv.' =CONVERT(NUMERIC(10,2),t1_0.hodin_odv_obs),'Druh Práce'= '' FROM dba.zdr_vp_pol t1_0,dba.zdr_vp_dkl t2_1 with(index( pk_zdr_vp_dkl)) ,dba.zakcis t3_13 with(index( pk_zakcis)) ,dba.zdr_uko t4_2 with(index( pk_zdr_uko)) ,dba.zdr_poz t5_3 with(index( pk_zdr_poz)) ,dba.odb_osoby t6_27 with(index( pk_odb_osoby)) WHERE ((t2_1.storno=0 and t1_0.kooperace=0 and t6_27.osoba='*USR_FLD1*') AND ( (*USR_DATETYPE* = 'Denní' AND t1_0.datum>=CONVERT(DATE,*USR_DATE*,105) AND t1_0.datum<DATEADD(DAY,1,CONVERT(DATE,*USR_DATE*,105))) OR (*USR_DATETYPE* = 'Měsíční' AND MONTH(t1_0.datum)=MONTH(CONVERT(DATE,*USR_DATE*,105)))) AND t1_0.fiskalni_rok=( YEAR( CONVERT(DATE,*USR_DATE*,105)) % 100 ) AND t6_27.osoba='*USR_FLD1*') AND (t2_1.doklad=t1_0.doklad) AND (t3_13.typ_zakazky=t1_0.typ_zakazky and t3_13.zakazka=t1_0.zakazka) AND (t4_2.id_ukolu=t1_0.id_ukolu) AND (t5_3.id_poz=t1_0.id_poz) AND (t6_27.osoba=t1_0.osoba) AND *USR_CHBGROUP*=1)z GROUP BY z.[Datum Odv.])y ORDER BY y.[Datum Odv.] ASC,y.[Oper] DESC,y.[Doklad Zdr.] ASC
NOAUTOSUM:True
COLUMNSUM:2/9/10
AUTOROOT:180
